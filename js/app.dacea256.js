(function(){"use strict";var t={7364:function(t,e,s){var r=s(8935),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[t._m(0),s("button",{staticClass:"cartBtn",attrs:{disabled:t.cartItemCount<1},on:{click:function(e){return t.switchView()}}},[t._v(" "+t._s(t.cartItemCount)+" Checkout "),s("span",{staticClass:"fas fa-cart-plus"})]),t.showLessons?s("div",{attrs:{id:"shopping"}},[s("display-lessons",{attrs:{lessons:t.lessons},on:{addLesson:t.addToCart,updateResults:t.updateResults}})],1):s("div",[s("cart-form",{attrs:{listOfCartQuantitiesForIds:t.listOfCartQuantitiesForIds,lessons:t.lessons},on:{emptyCart:t.emptyCart,removeFromCart:t.removeFromCart}})],1)])},o=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",[s("h1",[t._v("After School Club")])])}],a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",[s("h2",[t._v("Lessons")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchInput,expression:"searchInput"}],staticClass:"search",attrs:{type:"text",placeholder:"Search lessons"},domProps:{value:t.searchInput},on:{keyup:function(e){return t.updateResults()},input:function(e){e.target.composing||(t.searchInput=e.target.value)}}}),s("div",{staticClass:"sortedBy"},[t._v(" sorted by "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.filter,expression:"filter"}],staticClass:"sortingFont",on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.filter=e.target.multiple?s:s[0]},function(e){return t.updateResults()}]}},[s("option",{attrs:{value:"topic"}},[t._v("Topic")]),s("option",{attrs:{value:"location"}},[t._v("Location")]),s("option",{attrs:{value:"price"}},[t._v("Price")]),s("option",{attrs:{value:"available_space"}},[t._v("Space")])]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.sortDirection,expression:"sortDirection"}],attrs:{type:"radio",id:"asc",value:"asc"},domProps:{checked:t._q(t.sortDirection,"asc")},on:{change:[function(e){t.sortDirection="asc"},function(e){return t.updateResults()}]}}),s("label",{attrs:{for:"ascending"}},[t._v("Ascending")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.sortDirection,expression:"sortDirection"}],attrs:{type:"radio",id:"desc",value:"desc"},domProps:{checked:t._q(t.sortDirection,"desc")},on:{change:[function(e){t.sortDirection="desc"},function(e){return t.updateResults()}]}}),s("label",{attrs:{for:"descending"}},[t._v("Descending")])]),s("br"),s("br"),t._l(t.lessons,(function(e){return s("div",{key:e.id,staticClass:"lesson"},[s("br"),s("img",{attrs:{src:t.getImage(e.image),height:"150"}}),s("h2",[t._v(" "+t._s(e.topic)+" "),s("span",{class:t.getFontAwesomeIcon(e)})]),s("p",[t._v("Location: "+t._s(e.location))]),s("p",[t._v("Price: £"+t._s(e.price))]),s("p",[t._v("Spaces: "+t._s(e.available_space))]),s("button",{staticClass:"cartBtn",attrs:{disabled:!t.canAddToCart(e)},on:{click:function(s){return t.addToCart(e.id)}}},[t._v("Add to cart")]),s("br"),s("br")])}))],2)},i=[],c={name:"displayLessons",props:["lessons"],data(){return{filter:"price",sortDirection:"asc",order:{name:"",phoneNumber:""},searchInput:""}},methods:{addToCart(t){this.$emit("addLesson",t)},canAddToCart(t){let e=t.available_space;return e>0},updateResults(){this.$emit("updateResults",this.searchInput,this.filter,this.sortDirection)},getImage(t){return"https://cst3145-booking-system.herokuapp.com/"+t},getFontAwesomeIcon(t){return t.font_awesome_icon}}},l=c,u=s(1001),p=(0,u.Z)(l,a,i,!1,null,null,null),d=p.exports,h=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",[s("h2",[t._v("Cart")]),t._l(t.listOfCartQuantitiesForIds,(function(e){return s("div",{key:e.id},t._l(t.lessons,(function(r){return s("div",{key:r.id},[e.id===r.id&&e.amountInCart>=1?s("span",[s("div",{staticClass:"lesson"},[s("img",{attrs:{src:t.getImage(r.image),height:"150"}}),s("h2",[t._v(" "+t._s(r.topic)+" "),s("span",{class:t.getFontAwesomeIcon(r)})]),s("p",[t._v("Location: "+t._s(r.location))]),s("p",[t._v("Price: £"+t._s(r.price))]),s("p",[t._v("Quantity: "+t._s(e.amountInCart))]),s("button",{staticClass:"cartBtn",on:{click:function(e){return t.removeFromCart(r.id)}}},[t._v("Remove from cart")])])]):t._e()])})),0)})),s("br"),s("br"),s("div",{staticClass:"checkoutForm"},[s("h2",[t._v("Checkout")]),s("a",[t._v("Full Name:")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.order.name,expression:"order.name"}],attrs:{type:"text"},domProps:{value:t.order.name},on:{input:function(e){e.target.composing||t.$set(t.order,"name",e.target.value)}}}),s("a",{staticClass:"phone"},[t._v("Phone Number:")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.order.phoneNumber,expression:"order.phoneNumber"}],domProps:{value:t.order.phoneNumber},on:{input:function(e){e.target.composing||t.$set(t.order,"phoneNumber",e.target.value)}}}),s("br"),s("br"),s("button",{staticClass:"cartBtn",attrs:{disabled:!this.canCheckout},on:{click:function(e){return t.completeCheckout()}}},[t._v("Checkout")])])],2)},m=[],f={name:"displayLessons",props:["listOfCartQuantitiesForIds","lessons","cart"],data(){return{order:{name:"",phoneNumber:""}}},methods:{createNewOrder(t){fetch("https://cst3145-booking-system.herokuapp.com/collection/order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((t=>t.json())).then((t=>{console.log("Success:",t)}))},createLessonOrder(t,e){let s={name:this.order.name,phone_number:this.order.phoneNumber,lesson_id:t,space:e};this.createNewOrder(s)},updateLessonSpaces(t,e){fetch("https://cst3145-booking-system.herokuapp.com/collection/lesson/"+t,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({available_space:e})}).then((t=>t.json())).then((t=>{console.log("Success:",t)}))},updateSpecificLessonSpaces(t){let e=this.lessons.findIndex((e=>e.id==t));this.updateLessonSpaces(t,this.lessons[e].available_space)},orderAndUpdate(){for(let t=0;t<this.listOfCartQuantitiesForIds.length;t++){let e=this.listOfCartQuantitiesForIds[t].id,s=this.listOfCartQuantitiesForIds[t].amountInCart;s>0&&(this.createLessonOrder(e,s),this.updateSpecificLessonSpaces(e))}this.$emit("emptyCart"),this.showLessons=!0},completeCheckout(){this.orderAndUpdate(),alert("Checkout Complete")},getImage(t){return"https://cst3145-booking-system.herokuapp.com/"+t},removeFromCart(t){this.$emit("removeFromCart",t)},getFontAwesomeIcon(t){return t.font_awesome_icon}},computed:{canCheckout(){return!(!/^[a-zA-Z]+$/.test(this.order.name)||!/^\d+$/.test(this.order.phoneNumber))}}},v=f,_=(0,u.Z)(v,h,m,!1,null,null,null),g=_.exports,b={name:"App",data(){return{showLessons:!0,lessons:[],cart:[],filter:"price",sortDirection:"asc",order:{name:"",phoneNumber:""},searchInput:""}},methods:{switchView(){this.showLessons=!this.showLessons},addToCart(t){this.cart.push(t);let e=this.lessons.findIndex((e=>e.id==t));this.lessons[e].available_space=this.lessons[e].available_space-1},removeFromCart(t){const e=this.cart.indexOf(t),s=this.lessons.findIndex((e=>e.id==t));e>-1&&(this.cart.splice(e,1),this.lessons[s].available_space=this.lessons[s].available_space+1),0===this.cart.length&&this.switchView()},populateResultArray(){fetch(this.fetchString()).then((t=>{t.json().then((t=>{this.lessons=t}))}))},fetchString(){return""==this.searchInput?"https://cst3145-booking-system.herokuapp.com/collection/lesson/"+this.filter+"/"+this.sortDirection:"https://cst3145-booking-system.herokuapp.com/collection/lesson/"+this.searchInput+"/"+this.filter+"/"+this.sortDirection},emptyCart(){this.cart=[],this.switchView()},updateResults(t,e,s){this.searchInput=t,this.filter=e,this.sortDirection=s,this.populateResultArray()}},computed:{cartItemCount(){return this.cart.length},allItemIds(){let t=[];for(let e=0;e<this.lessons.length;e++)t.push(this.lessons[e].id);return t},listOfCartQuantitiesForIds(){let t=this.allItemIds,e=[];for(let s=0;s<t.length;s++){let r=0;for(let e=0;e<this.cart.length;e++)t[s]===this.cart[e]&&r++;e.push({id:t[s],amountInCart:r})}return e}},created:function(){this.populateResultArray()},components:{displayLessons:d,cartForm:g}},C=b,y=(0,u.Z)(C,n,o,!1,null,null,null),I=y.exports;r.Z.config.productionTip=!1,new r.Z({render:t=>t(I)}).$mount("#app")}},e={};function s(r){var n=e[r];if(void 0!==n)return n.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,s),o.exports}s.m=t,function(){var t=[];s.O=function(e,r,n,o){if(!r){var a=1/0;for(u=0;u<t.length;u++){r=t[u][0],n=t[u][1],o=t[u][2];for(var i=!0,c=0;c<r.length;c++)(!1&o||a>=o)&&Object.keys(s.O).every((function(t){return s.O[t](r[c])}))?r.splice(c--,1):(i=!1,o<a&&(a=o));if(i){t.splice(u--,1);var l=n();void 0!==l&&(e=l)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[r,n,o]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};s.O.j=function(e){return 0===t[e]};var e=function(e,r){var n,o,a=r[0],i=r[1],c=r[2],l=0;if(a.some((function(e){return 0!==t[e]}))){for(n in i)s.o(i,n)&&(s.m[n]=i[n]);if(c)var u=c(s)}for(e&&e(r);l<a.length;l++)o=a[l],s.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return s.O(u)},r=self["webpackChunkafterschoolclub"]=self["webpackChunkafterschoolclub"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=s.O(void 0,[998],(function(){return s(7364)}));r=s.O(r)})();
//# sourceMappingURL=app.dacea256.js.map